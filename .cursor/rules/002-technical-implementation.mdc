# æŠ€æœ¯å®ç°æŒ‡å¯¼

## ğŸ”§ Markdown-it ä»¤ç‰Œå¤„ç†

### ä»¤ç‰Œç±»å‹ç†è§£
- **å†…è”ä»¤ç‰Œ**ï¼šå¤„ç†æ–‡æœ¬ã€é“¾æ¥ã€å¼ºè°ƒç­‰å†…è”å…ƒç´ 
- **å—çº§ä»¤ç‰Œ**ï¼šå¤„ç†æ ‡é¢˜ã€æ®µè½ã€åˆ—è¡¨ã€ä»£ç å—ç­‰å—çº§å…ƒç´ 
- **åµŒå¥—å†…å®¹**ï¼šæ­£ç¡®å¤„ç†å¤æ‚çš„åµŒå¥—ç»“æ„

### ä»¤ç‰Œå¤„ç†æ¨¡å¼
```javascript
// å¤„ç†å†…è”ä»¤ç‰Œ
function processInlineTokens(tokens) {
    return tokens.map(token => {
        switch (token.type) {
            case 'text': return processTextToken(token);
            case 'link_open': return processLinkToken(token);
            case 'strong_open': return processStrongToken(token);
            default: return token;
        }
    });
}

// å¤„ç†å—çº§ä»¤ç‰Œ
function processBlockTokens(tokens) {
    return tokens.map(token => {
        switch (token.type) {
            case 'heading_open': return processHeadingToken(token);
            case 'code_block': return processCodeBlockToken(token);
            case 'list_item_open': return processListItemToken(token);
            default: return token;
        }
    });
}
```

## ğŸ—ï¸ QQ æ€ç»´å¯¼å›¾æ•°æ®ç»“æ„

### èŠ‚ç‚¹å±‚æ¬¡ç»“æ„
- **çˆ¶å­å…³ç³»**ï¼šç†è§£èŠ‚ç‚¹é—´çš„å±‚çº§å…³ç³»
- **åŒçº§èŠ‚ç‚¹**ï¼šæ­£ç¡®å¤„ç†ç›¸åŒå±‚çº§çš„èŠ‚ç‚¹
- **èŠ‚ç‚¹ç±»å‹**ï¼šåŒºåˆ†æ ‡é¢˜ã€æ–‡æœ¬ã€ä»£ç å—ã€å›¾ç‰‡ç­‰ä¸åŒç±»å‹
- **èŠ‚ç‚¹å±æ€§**ï¼šå¤„ç†èŠ‚ç‚¹çš„å„ç§å±æ€§å’Œå…ƒæ•°æ®

### å¯Œæ–‡æœ¬å¤„ç†
- **æ ¼å¼åŒ–æ–‡æœ¬**ï¼šå¤„ç†å¸¦æœ‰æ ·å¼å’Œé“¾æ¥çš„æ–‡æœ¬
- **å†…è”æ ¼å¼**ï¼šå¤„ç†ç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿ç­‰æ ¼å¼
- **é“¾æ¥å¤„ç†**ï¼šæ­£ç¡®å¤„ç†å†…éƒ¨å’Œå¤–éƒ¨é“¾æ¥
- **å›¾ç‰‡æ•°æ®**ï¼šå¤„ç†å›¾ç‰‡çš„å°ºå¯¸ã€altæ–‡æœ¬å’Œæ ‡é¢˜

### æ³¨é‡Šå­—æ®µ
- **å…ƒæ•°æ®ä¿å­˜**ï¼šåœ¨ notes å­—æ®µä¸­ä¿å­˜é¢å¤–ä¿¡æ¯
- **ä»£ç å—å†…å®¹**ï¼šå°†ä»£ç å—å†…å®¹å­˜å‚¨åœ¨ notes ä¸­
- **å›¾ç‰‡ä¿¡æ¯**ï¼šä¿å­˜å›¾ç‰‡çš„å®Œæ•´ä¿¡æ¯
- **è‡ªå®šä¹‰æ•°æ®**ï¼šæ”¯æŒé¡¹ç›®ç‰¹å®šçš„å…ƒæ•°æ®

## ğŸ“‹ è½¬æ¢æ¨¡å¼

### èŠ‚ç‚¹è½¬æ¢ç¤ºä¾‹
```javascript
// QQ èŠ‚ç‚¹åˆ° Markdown è½¬æ¢
function convertNode(node, indent, isListItem) {
    let result = '';
    
    if (node.title && node.title.text) {
        const text = convertRichTextToMarkdown(node.title);
        result += `${indent}${text}\n`;
    }
    
    if (node.children && node.children.attached) {
        for (const child of node.children.attached) {
            result += convertNode(child, indent + '  ', false);
        }
    }
    
    return result;
}
```

### å¯Œæ–‡æœ¬è½¬æ¢
```javascript
// å¯Œæ–‡æœ¬åˆ° Markdown è½¬æ¢
function convertRichTextToMarkdown(titleObject) {
    if (typeof titleObject === 'string') {
        return titleObject;
    }
    
    let result = '';
    if (titleObject.styles) {
        for (const style of titleObject.styles) {
            switch (style.type) {
                case 'bold': result += `**${style.text}**`; break;
                case 'italic': result += `*${style.text}*`; break;
                case 'link': result += `[${style.text}](${style.url})`; break;
                default: result += style.text;
            }
        }
    }
    
    return result || titleObject.text || '';
}
```

## ğŸ¯ ç‰¹æ®Šå†…å®¹å¤„ç†

### ä»£ç å—å¤„ç†
```javascript
// ä»£ç å—è½¬æ¢
function convertCodeBlock(node) {
    const notesContent = node.notes?.content;
    if (!notesContent) return '';
    
    // ä» notes ä¸­æå–ä»£ç å†…å®¹
    const codeMatch = notesContent.match(/<pre><code>(.*?)<\/code><\/pre>/s);
    if (codeMatch) {
        const codeContent = unescapeHtml(codeMatch[1]);
        const language = extractLanguageFromTitle(node.title);
        return `\`\`\`${language}\n${codeContent}\n\`\`\`\n`;
    }
    
    return '';
}

// ä»£ç å—è½¬æ¢ç¤ºä¾‹
function createCodeBlockNode(codeLines, language) {
    const codeContent = codeLines.join('\n');
    const title = language ? `\`\`\`${language}` : '```';
    
    return {
        title: createRichTextNode(title),
        labels: [CODE_BLOCK_LABEL],
        notes: { content: `<pre><code>${escapeHtml(codeContent)}</code></pre>` },
        children: { attached: [] }
    };
}
```

### å›¾ç‰‡å¤„ç†
```javascript
// å›¾ç‰‡è½¬æ¢
function convertImage(node) {
    const notesContent = node.notes?.content;
    if (!notesContent) return '';
    
    // ä» notes ä¸­æå–å›¾ç‰‡ä¿¡æ¯
    const imgMatch = notesContent.match(/<img[^>]+src="([^"]+)"[^>]*>/);
    if (imgMatch) {
        const src = imgMatch[1];
        const alt = extractAltText(notesContent);
        const title = extractTitle(notesContent);
        
        let result = `![${alt}](${src})`;
        if (title) result += ` "${title}"`;
        return result + '\n';
    }
    
    return '';
}
```

### åˆ†å‰²çº¿å¤„ç†
```javascript
// åˆ†å‰²çº¿è½¬æ¢
function convertDivider(node) {
    if (node.labels && node.labels.includes('divider')) {
        return '---\n';
    }
    return '';
}
```

## ğŸ” æ•°æ®å®Œæ•´æ€§

### åŒå‘è½¬æ¢éªŒè¯
- ç¡®ä¿ MDâ†’QQâ†’MD è½¬æ¢ä¿æŒæ•°æ®å®Œæ•´æ€§
- éªŒè¯æ‰€æœ‰é‡è¦ä¿¡æ¯éƒ½è¢«ä¿ç•™
- æ£€æŸ¥æ ¼å¼å’Œç»“æ„çš„æ­£ç¡®æ€§
- å¤„ç†è½¬æ¢è¿‡ç¨‹ä¸­çš„æ•°æ®ä¸¢å¤±

### è¾¹ç¼˜æƒ…å†µå¤„ç†
- å¤„ç†ç©ºèŠ‚ç‚¹å’Œæ— æ•ˆæ•°æ®
- å¤„ç†å¤æ‚çš„åµŒå¥—ç»“æ„
- å¤„ç†ä¸å®Œæ•´æˆ–æŸåçš„æ•°æ®
- ä¼˜é›…åœ°å¤„ç†æœªçŸ¥çš„èŠ‚ç‚¹ç±»å‹

### æ€§èƒ½ä¼˜åŒ–
- ä¼˜åŒ–å¤§æ–‡æ¡£çš„å¤„ç†é€Ÿåº¦
- å‡å°‘å†…å­˜ä½¿ç”¨å’Œåƒåœ¾å›æ”¶
- ä½¿ç”¨é«˜æ•ˆçš„ç®—æ³•è¿›è¡ŒèŠ‚ç‚¹éå†
- è€ƒè™‘ç¼“å­˜å’Œé¢„è®¡ç®—

## ğŸ“š æœ€ä½³å®è·µ

### èŠ‚ç‚¹éå†
- ä½¿ç”¨æ·±åº¦ä¼˜å…ˆéå†å¤„ç†èŠ‚ç‚¹æ ‘
- æ­£ç¡®å¤„ç†èŠ‚ç‚¹çš„å±‚çº§å…³ç³»
- é¿å…æ— é™é€’å½’å’Œå¾ªç¯å¼•ç”¨
- ä¼˜åŒ–éå†ç®—æ³•çš„æ€§èƒ½

### é”™è¯¯å¤„ç†
- æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯æ¶ˆæ¯
- ä¼˜é›…åœ°å¤„ç†æ ¼å¼é”™è¯¯
- è®°å½•è½¬æ¢è¿‡ç¨‹ä¸­çš„é—®é¢˜
- æ”¯æŒéƒ¨åˆ†è½¬æ¢å’Œé”™è¯¯æ¢å¤

### ç‰¹æ®Šå­—ç¬¦å¤„ç†
```javascript
// HTML è½¬ä¹‰å‡½æ•°
function escapeHtml(text) {
    return text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
}

// HTML åè½¬ä¹‰å‡½æ•°
function unescapeHtml(text) {
    return text
        .replace(/&amp;/g, '&')
        .replace(/&lt;/g, '<')
        .replace(/&gt;/g, '>')
        .replace(/&quot;/g, '"')
        .replace(/&#39;/g, "'");
}
```

### å¯Œæ–‡æœ¬å¤„ç†
```javascript
// å¯Œæ–‡æœ¬è½¬æ¢ç¤ºä¾‹
function createRichTextNode(markdown) {
    const tokens = markdownIt.parse(markdown, {});
    return buildRichTextFromTokens(tokens);
}

function buildRichTextFromTokens(tokens) {
    // æ„å»ºå¯Œæ–‡æœ¬ç»“æ„çš„é€»è¾‘
    // å¤„ç†å†…è”æ ¼å¼ã€é“¾æ¥ã€å›¾ç‰‡ç­‰
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- ç¼“å­˜è§£æç»“æœä»¥é¿å…é‡å¤å¤„ç†
- ä½¿ç”¨æµå¼å¤„ç†å¤„ç†å¤§æ–‡æ¡£
- ä¼˜åŒ–ä»¤ç‰Œéå†ç®—æ³•
- è€ƒè™‘å†…å­˜ä½¿ç”¨å’Œåƒåœ¾å›æ”¶

### å­¦ä¹ èµ„æº
- **å®˜æ–¹æ–‡æ¡£**ï¼šä½¿ç”¨ MCP Context7 è®¿é—® markdown-it æ–‡æ¡£
- **æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ**ï¼šæ¢ç´¢ç°æœ‰æ’ä»¶ä»¥è·å–çµæ„Ÿ
- **ä»¤ç‰Œå¤„ç†**ï¼šæ·±å…¥äº†è§£ markdown-it çš„ä»¤ç‰Œç³»ç»Ÿ
- **æœ€ä½³å®è·µ**ï¼šéµå¾ªå·²å»ºç«‹çš„ markdown å¤„ç†æ¨¡å¼
description:
globs:
alwaysApply: false
---
