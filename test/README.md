# QQmindmap2Obsidian æµ‹è¯•å•å…ƒè¯´æ˜æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æµ‹è¯•å•å…ƒä¸º QQmindmap2Obsidian é¡¹ç›®æä¾›äº†ä¸€å¥—å®Œæ•´çš„æµ‹è¯•æ¶æ„ï¼Œä¸“é—¨é’ˆå¯¹ Markdown ä¸ QQ æ€ç»´å¯¼å›¾ä¹‹é—´çš„åŒå‘è½¬æ¢åŠŸèƒ½è¿›è¡Œæµ‹è¯•ã€‚**é€‚é… Tampermonkey ç¯å¢ƒï¼Œä½¿ç”¨ CDN ä¾èµ–è€Œé npm æ¨¡å—**ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒç‰¹ç‚¹
- **æ•°æ®å¤ç”¨**ï¼šé¿å…é‡å¤ç”Ÿæˆå¤§é‡å ä½ç¬¦ï¼Œæé«˜æµ‹è¯•æ•ˆç‡
- **ç®€åŒ–è®¾è®¡**ï¼šä½¿ç”¨ `SimpleTestSuite` æ›¿ä»£å¤æ‚çš„æ¨¡å—ç³»ç»Ÿ
- **Tampermonkeyé€‚é…**ï¼šæ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒå’ŒCDNä¾èµ–
- **é…ç½®é©±åŠ¨**ï¼šé€šè¿‡é…ç½®æ–‡ä»¶ç»Ÿä¸€æ§åˆ¶æµ‹è¯•è¡Œä¸º
- **æ ‡å‡†åŒ–æŠ¥å‘Š**ï¼šç»Ÿä¸€çš„æµ‹è¯•æŠ¥å‘Šå’ŒéªŒè¯æ ‡å‡†

### ç›®å½•ç»“æ„
```
test/
â”œâ”€â”€ fixtures/              # æµ‹è¯•æ•°æ®æ¨¡å—
â”‚   â””â”€â”€ testData.js       # æ ¸å¿ƒæµ‹è¯•æ•°æ®
â”œâ”€â”€ utils/                # æµ‹è¯•å·¥å…·æ¨¡å—
â”‚   â””â”€â”€ testHelpers.js    # é€šç”¨æµ‹è¯•å·¥å…·
â”œâ”€â”€ suites/               # æµ‹è¯•å¥—ä»¶æ¨¡å—ï¼ˆå‚è€ƒå®ç°ï¼‰
â”‚   â””â”€â”€ conversionTestSuite.js  # è½¬æ¢æµ‹è¯•å¥—ä»¶æ¨¡æ¿
â”œâ”€â”€ config/               # é…ç½®æ¨¡å—
â”‚   â””â”€â”€ testConfig.js     # æµ‹è¯•é…ç½®
â”œâ”€â”€ results/              # æµ‹è¯•ç»“æœï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ runTests.js           # ä¸»è¿è¡Œè„šæœ¬ï¼ˆå®é™…ä½¿ç”¨ï¼‰
â””â”€â”€ README.md             # æœ¬æ–‡æ¡£
```

## ğŸ§ª æµ‹è¯•æ•°æ®æ¨¡å— (fixtures/testData.js)

### åŠŸèƒ½è¯´æ˜
æä¾›ä»£è¡¨æ€§çš„æµ‹è¯•ç”¨ä¾‹ï¼Œé¿å…é‡å¤ç”Ÿæˆå¤§é‡å ä½ç¬¦ã€‚

### æ•°æ®ç»“æ„
```javascript
{
    testName: {
        markdown: "æµ‹è¯•ç”¨çš„Markdownå†…å®¹",
        description: "æµ‹è¯•ç”¨ä¾‹æè¿°"
    }
}
```

### æµ‹è¯•ç”¨ä¾‹åˆ†ç±»

#### åŸºç¡€æµ‹è¯•ç”¨ä¾‹ (BASE_TEST_DATA)
- `simpleHeader`: åŸºç¡€æ ‡é¢˜ç»“æ„
- `multiLevelHeader`: å¤šçº§æ ‡é¢˜å±‚çº§
- `parallelText`: åŒçº§æ–‡æœ¬èŠ‚ç‚¹ï¼ˆé—®é¢˜1ï¼‰
- `codeBlockWithSpecialChars`: ä»£ç å—ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼ˆé—®é¢˜2ï¼‰
- `complexCodeBlock`: å¤æ‚ä»£ç å—ï¼ˆåŸå§‹é—®é¢˜ï¼‰
- `listStructure`: åˆ—è¡¨å±‚çº§ç»“æ„
- `imageHandling`: å›¾ç‰‡altå’Œtitleå¤„ç†
- `divider`: åˆ†å‰²çº¿å¤„ç†
- `mixedContent`: ç»¼åˆæµ‹è¯•ç”¨ä¾‹

#### è¾¹ç•Œæµ‹è¯•ç”¨ä¾‹ (EDGE_CASES)
- `emptyContent`: ç©ºè¡Œå¤„ç†
- `specialCharacters`: HTMLç‰¹æ®Šå­—ç¬¦è½¬ä¹‰
- `nestedStructure`: æ·±å±‚åµŒå¥—ç»“æ„
- `longText`: é•¿æ–‡æœ¬æ€§èƒ½æµ‹è¯•

#### é”™è¯¯æµ‹è¯•ç”¨ä¾‹ (ERROR_CASES)
- `malformedMarkdown`: æ ‡é¢˜å±‚çº§è·³è·ƒ
- `unclosedCodeBlock`: æœªé—­åˆä»£ç å—

### ä½¿ç”¨æ–¹æ³•
```javascript
const { BASE_TEST_DATA, EDGE_CASES, ERROR_CASES } = require('./fixtures/testData');

// è·å–æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹
const allCases = getAllTestCases();

// è·å–ç‰¹å®šç±»å‹çš„æµ‹è¯•ç”¨ä¾‹
const basicCases = getTestCasesByType('base');
```

## ğŸ”§ æµ‹è¯•å·¥å…·æ¨¡å— (utils/testHelpers.js)

### åŠŸèƒ½è¯´æ˜
æä¾›é€šç”¨çš„æµ‹è¯•è¾…åŠ©å‡½æ•°å’ŒéªŒè¯æ–¹æ³•ã€‚

### æ ¸å¿ƒç»„ä»¶

#### MockIndentManager
æ¨¡æ‹Ÿç¼©è¿›ç®¡ç†å™¨ï¼Œç”¨äºæµ‹è¯•ç¯å¢ƒã€‚

#### TestValidator
æµ‹è¯•éªŒè¯å™¨ï¼Œæä¾›å¤šç§éªŒè¯æ–¹æ³•ï¼š

- `validateNodeStructure(node, expected)`: éªŒè¯èŠ‚ç‚¹ç»“æ„
- `validateConversionIntegrity(original, converted)`: éªŒè¯è½¬æ¢å®Œæ•´æ€§
- `validateBidirectionalConversion(original, mdToQQ, qqToMD)`: éªŒè¯åŒå‘è½¬æ¢

#### PerformanceTester
æ€§èƒ½æµ‹è¯•å·¥å…·ï¼š

- `testPerformance(converter, testData, iterations)`: æµ‹è¯•è½¬æ¢æ€§èƒ½

### ä½¿ç”¨æ–¹æ³•
```javascript
const { TestValidator, PerformanceTester, mockMarkdownIt } = require('./utils/testHelpers');

// éªŒè¯èŠ‚ç‚¹ç»“æ„
const result = TestValidator.validateNodeStructure(node, expected);

// æ€§èƒ½æµ‹è¯•
const perfResult = PerformanceTester.testPerformance(converter, testData, 100);
```

## ğŸ§ª æµ‹è¯•å¥—ä»¶æ¨¡å— (suites/conversionTestSuite.js)

### åŠŸèƒ½è¯´æ˜
æä¾›å®Œæ•´çš„æµ‹è¯•å¥—ä»¶æ¨¡æ¿ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨æµ‹è¯•æ•°æ®å’Œå·¥å…·ã€‚**æ³¨æ„ï¼šå½“å‰å®é™…ä½¿ç”¨çš„æ˜¯ `runTests.js` ä¸­çš„ `SimpleTestSuite` ç±»**ã€‚

### æ ¸å¿ƒæ–¹æ³•

#### runBasicTests()
è¿è¡ŒåŸºç¡€åŠŸèƒ½æµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š
- ç®€å•æ ‡é¢˜è½¬æ¢
- åŒçº§æ–‡æœ¬å¤„ç†
- ä»£ç å—ç‰¹æ®Šå­—ç¬¦å¤„ç†
- å¤æ‚ä»£ç å—å¤„ç†

#### runEdgeTests()
è¿è¡Œè¾¹ç•Œæµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š
- ç©ºå†…å®¹å¤„ç†
- ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰
- æ·±å±‚åµŒå¥—ç»“æ„
- é•¿æ–‡æœ¬æ€§èƒ½

#### runErrorTests()
è¿è¡Œé”™è¯¯å¤„ç†æµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š
- æ ¼å¼é”™è¯¯å¤„ç†
- æœªé—­åˆä»£ç å—å¤„ç†

#### runPerformanceTests()
è¿è¡Œæ€§èƒ½æµ‹è¯•ï¼Œæµ‹é‡ï¼š
- MDâ†’QQ è½¬æ¢æ€§èƒ½
- QQâ†’MD è½¬æ¢æ€§èƒ½

### ä½¿ç”¨æ–¹æ³•
```javascript
const ConversionTestSuite = require('./suites/conversionTestSuite');

const testSuite = new ConversionTestSuite();
const results = testSuite.runAllTests();
```

## âš™ï¸ é…ç½®æ¨¡å— (config/testConfig.js)

### åŠŸèƒ½è¯´æ˜
ç»Ÿä¸€ç®¡ç†æµ‹è¯•å‚æ•°å’Œè®¾ç½®ã€‚

### é…ç½®é¡¹è¯´æ˜

#### environment
- `verbose`: æ˜¯å¦å¯ç”¨è¯¦ç»†æ—¥å¿—
- `saveResults`: æ˜¯å¦ä¿å­˜æµ‹è¯•ç»“æœåˆ°æ–‡ä»¶
- `outputDir`: æµ‹è¯•ç»“æœè¾“å‡ºç›®å½•
- `performanceIterations`: æ€§èƒ½æµ‹è¯•è¿­ä»£æ¬¡æ•°
- `timeout`: è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰

#### testData
- `basic.enabled`: æ˜¯å¦å¯ç”¨åŸºç¡€æµ‹è¯•
- `edge.enabled`: æ˜¯å¦å¯ç”¨è¾¹ç•Œæµ‹è¯•
- `error.enabled`: æ˜¯å¦å¯ç”¨é”™è¯¯æµ‹è¯•

#### validation
- `checkContentIntegrity`: æ˜¯å¦éªŒè¯å†…å®¹å®Œæ•´æ€§
- `checkStructureIntegrity`: æ˜¯å¦éªŒè¯ç»“æ„å®Œæ•´æ€§
- `checkBidirectionalConversion`: æ˜¯å¦éªŒè¯åŒå‘è½¬æ¢
- `allowedContentDifference`: å…è®¸çš„å†…å®¹å·®å¼‚ç™¾åˆ†æ¯”

#### performance
- `benchmarks`: æ€§èƒ½åŸºå‡†è®¾ç½®
- `warnings`: æ€§èƒ½è­¦å‘Šé˜ˆå€¼

### ä½¿ç”¨æ–¹æ³•
```javascript
const testConfig = require('./config/testConfig');

// æ£€æŸ¥æ˜¯å¦å¯ç”¨è¯¦ç»†æ—¥å¿—
if (testConfig.environment.verbose) {
    console.log('è¯¦ç»†æ—¥å¿—è¾“å‡º');
}
```

## ğŸš€ ä¸»è¿è¡Œè„šæœ¬ (runTests.js)

### åŠŸèƒ½è¯´æ˜
æä¾›å®Œæ•´çš„æµ‹è¯•è¿è¡Œå…¥å£ï¼Œæ”¯æŒå‘½ä»¤è¡Œå‚æ•°ã€‚**é€‚é… Tampermonkey ç¯å¢ƒï¼Œä½¿ç”¨ CDN ä¾èµ–**ã€‚

### æ ¸å¿ƒç‰¹ç‚¹
- **Tampermonkeyé€‚é…**: æ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒå’ŒCDNä¾èµ–
- **ç®€åŒ–è®¾è®¡**: ä½¿ç”¨ `SimpleTestSuite` æ›¿ä»£å¤æ‚çš„æ¨¡å—ç³»ç»Ÿ
- **æ•°æ®å¤ç”¨**: é€šè¿‡ `testData.js` é¿å…é‡å¤ç”Ÿæˆå ä½ç¬¦
- **é…ç½®é©±åŠ¨**: é€šè¿‡ `testConfig.js` ç»Ÿä¸€ç®¡ç†æµ‹è¯•è¡Œä¸º

### å‘½ä»¤è¡Œé€‰é¡¹
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
node test/runTests.js

# åªè¿è¡ŒåŸºç¡€æµ‹è¯•
node test/runTests.js --basic-only

# è·³è¿‡æ€§èƒ½æµ‹è¯•
node test/runTests.js --no-performance

# è¯¦ç»†è¾“å‡º
node test/runTests.js --verbose

# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
node test/runTests.js --help
```

### è¾“å‡ºç»“æœ
- æ§åˆ¶å°å®æ—¶è¾“å‡ºæµ‹è¯•è¿›åº¦
- è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
- ä¿å­˜è¯¦ç»†ç»“æœåˆ° JSON æ–‡ä»¶
- æä¾›æ€§èƒ½åˆ†ææ•°æ®

## ğŸ“Š æµ‹è¯•æŠ¥å‘Šæ ¼å¼

### åŸºç¡€æŠ¥å‘Š
```json
{
  "report": {
    "passed": 8,
    "failed": 1,
    "total": 9,
    "details": [
      {
        "name": "simpleHeader",
        "type": "basic",
        "description": "åŸºç¡€æ ‡é¢˜ç»“æ„",
        "passed": true,
        "errors": [],
        "warnings": []
      }
    ]
  }
}
```

### æ€§èƒ½æŠ¥å‘Š
```json
{
  "performanceResults": {
    "simpleHeader": {
      "mdToQQ": {
        "totalTime": 15.2,
        "averageTime": 0.152,
        "iterations": 100,
        "throughput": 657.89
      },
      "qqToMD": {
        "totalTime": 8.5,
        "averageTime": 0.085,
        "iterations": 100,
        "throughput": 1176.47
      }
    }
  }
}
```

## ğŸ” æµ‹è¯•éªŒè¯æ ‡å‡†

### å†…å®¹å®Œæ•´æ€§éªŒè¯
- æ ‡é¢˜å†…å®¹å¿…é¡»ä¿ç•™
- ä»£ç å—å†…å®¹å¿…é¡»å®Œæ•´
- åˆ—è¡¨ç»“æ„å¿…é¡»ä¿æŒ
- å›¾ç‰‡ä¿¡æ¯å¿…é¡»ä¿ç•™

### ç»“æ„å®Œæ•´æ€§éªŒè¯
- æ ‡é¢˜å±‚çº§å¿…é¡»æ­£ç¡®
- èŠ‚ç‚¹å…³ç³»å¿…é¡»å‡†ç¡®
- ç¼©è¿›ç»“æ„å¿…é¡»ä¿æŒ
- ç‰¹æ®Šæ ‡ç­¾å¿…é¡»æ­£ç¡®

### åŒå‘è½¬æ¢éªŒè¯
- MDâ†’QQâ†’MD è½¬æ¢åå†…å®¹åº”åŸºæœ¬ä¸€è‡´
- å…³é”®ä¿¡æ¯ä¸åº”ä¸¢å¤±
- ç»“æ„å…³ç³»åº”ä¿æŒ
- æ€§èƒ½åº”åœ¨å¯æ¥å—èŒƒå›´å†…

## ğŸ› ï¸ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹
1. åœ¨ `fixtures/testData.js` ä¸­æ·»åŠ æ–°çš„æµ‹è¯•æ•°æ®
2. åœ¨ç›¸åº”çš„æµ‹è¯•åˆ†ç±»ä¸­æ·»åŠ ç”¨ä¾‹
3. æ›´æ–°æµ‹è¯•æè¿°å’Œé¢„æœŸç»“æœ

### æ·»åŠ æ–°çš„éªŒè¯è§„åˆ™
1. åœ¨ `utils/testHelpers.js` çš„ `TestValidator` ä¸­æ·»åŠ æ–°æ–¹æ³•
2. åœ¨æµ‹è¯•å¥—ä»¶ä¸­è°ƒç”¨æ–°çš„éªŒè¯æ–¹æ³•
3. æ›´æ–°é…ç½®æ–‡ä»¶ä¸­çš„éªŒè¯é€‰é¡¹

### è‡ªå®šä¹‰æµ‹è¯•é…ç½®
1. ä¿®æ”¹ `config/testConfig.js` ä¸­çš„é…ç½®é¡¹
2. æ ¹æ®é¡¹ç›®éœ€æ±‚è°ƒæ•´æ€§èƒ½åŸºå‡†
3. è®¾ç½®é€‚åˆçš„éªŒè¯è§„åˆ™

### é›†æˆçœŸå®è½¬æ¢å™¨
1. ä¿®æ”¹ `runTests.js` ä¸­çš„ `MockMarkdownToQQConverter` å’Œ `MockQQToMarkdownConverter`
2. æ›¿æ¢ä¸ºçœŸå®çš„è½¬æ¢å™¨é€»è¾‘
3. æ›´æ–°éªŒè¯è§„åˆ™ä»¥é€‚åº”çœŸå®è½¬æ¢ç»“æœ

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### æµ‹è¯•å¤±è´¥
- æ£€æŸ¥æµ‹è¯•æ•°æ®æ˜¯å¦æ­£ç¡®
- éªŒè¯è½¬æ¢å™¨æ˜¯å¦æ­£ç¡®å®ç°
- æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

#### æ€§èƒ½é—®é¢˜
- æ£€æŸ¥æ€§èƒ½åŸºå‡†è®¾ç½®
- åˆ†æè½¬æ¢å™¨å®ç°æ•ˆç‡
- è€ƒè™‘ä¼˜åŒ–ç®—æ³•

#### é…ç½®é—®é¢˜
- ç¡®è®¤é…ç½®æ–‡ä»¶æ ¼å¼æ­£ç¡®
- æ£€æŸ¥è·¯å¾„è®¾ç½®
- éªŒè¯æƒé™è®¾ç½®

### è°ƒè¯•æŠ€å·§
1. å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š`--verbose`
2. æŸ¥çœ‹ä¸­é—´ç»“æœï¼šå¯ç”¨ `saveIntermediateResults`
3. åˆ†ææ€§èƒ½ç“¶é¢ˆï¼šæŸ¥çœ‹æ€§èƒ½æŠ¥å‘Š
4. å¯¹æ¯”å†å²ç»“æœï¼šæŸ¥çœ‹ä¿å­˜çš„æµ‹è¯•ç»“æœ

## ğŸ“ˆ æœ€ä½³å®è·µ

### æµ‹è¯•ç¼–å†™
1. ä½¿ç”¨æœ‰æ„ä¹‰çš„æµ‹è¯•ç”¨ä¾‹åç§°
2. æä¾›æ¸…æ™°çš„æµ‹è¯•æè¿°
3. åŒ…å«è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯æƒ…å†µ
4. ä¿æŒæµ‹è¯•æ•°æ®çš„ä»£è¡¨æ€§

### æ€§èƒ½ä¼˜åŒ–
1. å®šæœŸè¿è¡Œæ€§èƒ½æµ‹è¯•
2. ç›‘æ§æ€§èƒ½å˜åŒ–è¶‹åŠ¿
3. è®¾ç½®åˆç†çš„æ€§èƒ½åŸºå‡†
4. ä¼˜åŒ–è½¬æ¢ç®—æ³•

### ç»´æŠ¤ç®¡ç†
1. å®šæœŸæ›´æ–°æµ‹è¯•æ•°æ®
2. åŠæ—¶ä¿®å¤å¤±è´¥çš„æµ‹è¯•
3. ä¿æŒæµ‹è¯•ä»£ç çš„å¯è¯»æ€§
4. è®°å½•é‡è¦çš„æµ‹è¯•å˜æ›´

## ğŸ“ æ”¯æŒä¸åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„ç›¸å…³ç« èŠ‚
2. æ£€æŸ¥æµ‹è¯•æ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯
3. å‚è€ƒé¡¹ç›®çš„ä¸»æ–‡æ¡£
4. æäº¤ Issue æˆ– Pull Request

---

**ç‰ˆæœ¬**: 2.0.0  
**æœ€åæ›´æ–°**: 2024å¹´12æœˆ  
**ç»´æŠ¤è€…**: QQmindmap2Obsidian å¼€å‘å›¢é˜Ÿ  
**ç¯å¢ƒ**: Tampermonkey + CDN ä¾èµ– 