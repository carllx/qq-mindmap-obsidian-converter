# QQmindmap2Obsidian 开发指南索引

## 📚 文档结构

```
docs/
├── CODE_BLOCK_PROCESSING_GUIDE.md    # 代码块处理开发指南
├── DEVELOPMENT_GUIDE_INDEX.md        # 本文档
└── README.md                         # 项目主要文档
```

## 🎯 核心开发指南

### 代码块处理开发指南
**文件**: `CODE_BLOCK_PROCESSING_GUIDE.md`

#### 主要内容
- **架构设计**: 代码块处理的核心组件和数据流
- **实现细节**: MD→QQ 和 QQ→MD 转换的具体实现
- **关键特性**: 语言标识、特殊字符、空行、代码块标记处理
- **测试策略**: 测试用例分类和验证方法
- **常见问题**: Unicode转义、双反斜杠、标记重复、缩进丢失等问题的解决方案
- **最佳实践**: 依赖库使用、错误处理、性能优化、可维护性
- **扩展指南**: 添加新语言支持、新特性、性能优化

#### 适用场景
- 开发代码块相关功能
- 修复代码块转换问题
- 添加新的编程语言支持
- 优化代码块处理性能
- 理解代码块转换原理

## 🔧 技术栈

### 核心依赖
- **markdown-it**: Markdown解析和渲染
- **he**: HTML实体编码/解码
- **JSDOM**: 虚拟浏览器环境（测试）

### 关键模块
- **MarkdownToQQConverter**: MD→QQ转换器
- **QQToMarkdownConverter**: QQ→MD转换器
- **RichTextFormatter**: 富文本格式处理器
- **IndentManager**: 缩进管理器
- **LinePreserver**: 行格式保持器

## 🎯 开发原则

### 1. 根本原因问题解决
- 分析问题的根本原因而非表面症状
- 考虑架构影响而非局部修复
- 确保双向转换的数据完整性

### 2. 模块化设计
- 单一职责原则
- 低耦合高内聚
- 清晰的模块边界

### 3. 测试驱动开发
- 全面的测试覆盖
- 边界情况测试
- 性能基准测试

### 4. 依赖库优先
- 充分利用现有库
- 避免重复实现
- 保持代码简洁

## 🚀 快速开始

### 1. 环境设置
```bash
# 克隆项目
git clone <repository-url>
cd QQmindmap2Obsidian

# 安装依赖
npm install

# 构建项目
node build.js
```

### 2. 运行测试
```bash
# 运行代码块测试
node test/finalCodeBlockTest.js

# 运行完整测试套件
node test/runTests.js
```

### 3. 开发流程
1. 分析需求
2. 设计解决方案
3. 实现功能
4. 编写测试
5. 验证效果
6. 更新文档

## 📋 开发检查清单

### 功能开发
- [ ] 分析根本原因
- [ ] 设计架构影响
- [ ] 实现核心功能
- [ ] 编写测试用例
- [ ] 验证双向转换
- [ ] 更新文档

### 问题修复
- [ ] 重现问题
- [ ] 分析根本原因
- [ ] 设计修复方案
- [ ] 实施修复
- [ ] 验证修复效果
- [ ] 更新测试用例

### 性能优化
- [ ] 识别性能瓶颈
- [ ] 设计优化方案
- [ ] 实施优化
- [ ] 验证性能提升
- [ ] 更新性能基准

## 🧪 测试指南

### 测试类型
1. **单元测试**: 测试单个函数或模块
2. **集成测试**: 测试模块间的交互
3. **端到端测试**: 测试完整的转换流程
4. **性能测试**: 测试转换速度和内存使用

### 测试用例
- **基础功能**: 简单的代码块转换
- **特殊字符**: 包含HTML实体和Unicode字符
- **中文字符**: 包含中文注释和字符串
- **复杂结构**: 嵌套代码块和混合内容
- **边界情况**: 空代码块、单行代码、大量内容

### 验证方法
- **格式验证**: 检查HTML结构和标记
- **内容验证**: 检查文本内容和字符编码
- **功能验证**: 检查转换的完整性和正确性
- **性能验证**: 检查转换速度和资源使用

## 🔍 调试指南

### 常见问题
1. **Unicode转义问题**: 中文字符显示为转义格式
2. **双反斜杠问题**: Unicode转义使用双反斜杠
3. **代码块标记重复**: 转换后出现重复标记
4. **缩进丢失**: 代码缩进在转换过程中丢失

### 调试工具
- **控制台日志**: 查看转换过程和中间结果
- **测试用例**: 使用专门的测试用例验证功能
- **格式检查**: 检查HTML结构和内容格式
- **性能分析**: 分析转换性能和内存使用

### 调试步骤
1. 重现问题
2. 分析错误信息
3. 检查相关代码
4. 设计修复方案
5. 实施修复
6. 验证修复效果

## 📈 性能优化

### 优化目标
- **转换速度**: 大型文档转换时间 < 2秒
- **内存使用**: 峰值内存使用 < 50MB
- **用户体验**: 响应时间 < 100ms

### 优化策略
- **缓存结果**: 避免重复计算
- **减少DOM操作**: 使用字符串处理
- **优化算法**: 使用更高效的算法
- **内存管理**: 及时释放大型对象

### 性能监控
- **转换时间**: 记录转换耗时
- **内存使用**: 监控内存占用
- **错误率**: 统计转换错误
- **用户体验**: 收集用户反馈

## 🔄 版本管理

### 版本号规则
- **主版本号**: 重大架构变更
- **次版本号**: 新功能添加
- **修订版本号**: 问题修复和优化

### 发布流程
1. 功能开发和测试
2. 性能验证
3. 文档更新
4. 版本标签
5. 发布说明

### 变更记录
- **新功能**: 记录新增功能
- **修复**: 记录问题修复
- **优化**: 记录性能优化
- **文档**: 记录文档更新

## 📞 支持与反馈

### 问题报告
- **GitHub Issues**: 报告问题和建议
- **详细描述**: 提供问题的详细描述
- **重现步骤**: 提供问题重现步骤
- **环境信息**: 提供环境信息

### 贡献指南
- **代码规范**: 遵循项目代码规范
- **测试要求**: 添加相应的测试用例
- **文档更新**: 更新相关文档
- **提交规范**: 使用语义化提交信息

### 联系方式
- **项目维护者**: carllx & Gemini
- **问题反馈**: GitHub Issues
- **功能建议**: GitHub Discussions

---

**版本**: 2.3  
**最后更新**: 2024年12月  
**维护者**: QQmindmap2Obsidian 开发团队 