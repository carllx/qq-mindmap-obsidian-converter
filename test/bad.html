<meta charset='utf-8'><html><head></head><body><div data-mind-map="[{&quot;type&quot;:5,&quot;data&quot;:{&quot;title&quot;:{&quot;children&quot;:[{&quot;type&quot;:&quot;paragraph&quot;,&quot;children&quot;:[{&quot;type&quot;:&quot;text&quot;,&quot;text&quot;:&quot;```cpp&quot;}]}],&quot;type&quot;:&quot;document&quot;},&quot;labels&quot;:[{&quot;id&quot;:&quot;qq-mind-map-code-block-label&quot;,&quot;text&quot;:&quot;code-block&quot;,&quot;backgroundColor&quot;:&quot;#F0F0F0&quot;,&quot;color&quot;:&quot;#000000&quot;}],&quot;notes&quot;:{&quot;content&quot;:&quot;&lt;p&gt;```cpp&lt;br&gt;// Arduino超声波传感器代码&lt;br&gt;// 用于与TouchDesigner通信&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;const int trigPin = 2;&nbsp;&nbsp;&nbsp;&nbsp;// 触发引脚&lt;br&gt;const int echoPin = 3;&nbsp;&nbsp;&nbsp;&nbsp;// 回声引脚&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;long duration;&lt;br&gt;int distance;&lt;br&gt;int smoothDistance;&lt;br&gt;int lastDistance = 0;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;void setup() {&lt;br&gt;&nbsp;&nbsp;// 初始化串口通信&lt;br&gt;&nbsp;&nbsp;Serial.begin(9600);&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 设置引脚模式&lt;br&gt;&nbsp;&nbsp;pinMode(trigPin, OUTPUT);&lt;br&gt;&nbsp;&nbsp;pinMode(echoPin, INPUT);&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;Serial.println(\\&quot;Arduino Ultrasonic Sensor Ready\\&quot;);&lt;br&gt;}&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;void loop() {&lt;br&gt;&nbsp;&nbsp;// 清除触发引脚&lt;br&gt;&nbsp;&nbsp;digitalWrite(trigPin, LOW);&lt;br&gt;&nbsp;&nbsp;delayMicroseconds(2);&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 发送10微秒的高电平脉冲&lt;br&gt;&nbsp;&nbsp;digitalWrite(trigPin, HIGH);&lt;br&gt;&nbsp;&nbsp;delayMicroseconds(10);&lt;br&gt;&nbsp;&nbsp;digitalWrite(trigPin, LOW);&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 读取回声引脚的脉冲持续时间&lt;br&gt;&nbsp;&nbsp;duration = pulseIn(echoPin, HIGH);&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 计算距离（厘米）&lt;br&gt;&nbsp;&nbsp;distance = duration * 0.034 / 2;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 简单的平滑滤波&lt;br&gt;&nbsp;&nbsp;smoothDistance = (distance + lastDistance) / 2;&lt;br&gt;&nbsp;&nbsp;lastDistance = smoothDistance;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 限制距离范围（0-200cm）&lt;br&gt;&nbsp;&nbsp;if (smoothDistance &gt; 200) {&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;smoothDistance = 200;&lt;br&gt;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;if (smoothDistance &lt; 0) {&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;smoothDistance = 0;&lt;br&gt;&nbsp;&nbsp;}&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 发送数据到TouchDesigner&lt;br&gt;&nbsp;&nbsp;// 格式：distance,normalized_value&lt;br&gt;&nbsp;&nbsp;float normalizedValue = smoothDistance / 200.0; // 归一化到0-1&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;Serial.print(smoothDistance);&lt;br&gt;&nbsp;&nbsp;Serial.print(\\&quot;,\\&quot;);&lt;br&gt;&nbsp;&nbsp;Serial.println(normalizedValue, 3);&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&nbsp;&nbsp;// 延迟以控制数据发送频率&lt;br&gt;&nbsp;&nbsp;delay(50); // 20Hz更新频率&lt;br&gt;}&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;&lt;br&gt;&lt;/p&gt;\n&lt;p&gt;```&lt;/p&gt;&quot;},&quot;children&quot;:{&quot;attached&quot;:[]}}}]"></div></body></html>